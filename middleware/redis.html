<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Redis 入门 | 奇风 Java 工程师知识体系</title>
    <meta name="generator" content="VuePress 1.9.8">
    <link rel="icon" href="https://cdn.nlark.com/yuque/0/2023/png/375413/1675405507715-d39c0d59-ff2f-48e2-916e-70c5c8a2e62d.png">
    <meta name="description" content="">
    <meta name="referrer" content="no-referrer">
    
    <link rel="preload" href="/assets/css/0.styles.112c01f0.css" as="style"><link rel="preload" href="/assets/js/app.52ddb80d.js" as="script"><link rel="preload" href="/assets/js/3.055d3e19.js" as="script"><link rel="preload" href="/assets/js/1.e976497e.js" as="script"><link rel="preload" href="/assets/js/88.837c1299.js" as="script"><link rel="prefetch" href="/assets/js/10.6a7508d8.js"><link rel="prefetch" href="/assets/js/11.08ed1d65.js"><link rel="prefetch" href="/assets/js/12.82d05f80.js"><link rel="prefetch" href="/assets/js/13.711ee55a.js"><link rel="prefetch" href="/assets/js/14.c609b159.js"><link rel="prefetch" href="/assets/js/15.6fd2ee9b.js"><link rel="prefetch" href="/assets/js/16.49d903d0.js"><link rel="prefetch" href="/assets/js/17.4615af89.js"><link rel="prefetch" href="/assets/js/18.a35d842c.js"><link rel="prefetch" href="/assets/js/19.4a9a65eb.js"><link rel="prefetch" href="/assets/js/20.1e2f13cb.js"><link rel="prefetch" href="/assets/js/21.bc4c505e.js"><link rel="prefetch" href="/assets/js/22.499c0484.js"><link rel="prefetch" href="/assets/js/23.0c7c443f.js"><link rel="prefetch" href="/assets/js/24.355046ed.js"><link rel="prefetch" href="/assets/js/25.e527923e.js"><link rel="prefetch" href="/assets/js/26.1b6146d9.js"><link rel="prefetch" href="/assets/js/27.d6277aca.js"><link rel="prefetch" href="/assets/js/28.783c6261.js"><link rel="prefetch" href="/assets/js/29.e250d2b0.js"><link rel="prefetch" href="/assets/js/30.848f8a9b.js"><link rel="prefetch" href="/assets/js/31.30ef5183.js"><link rel="prefetch" href="/assets/js/32.84c07ae3.js"><link rel="prefetch" href="/assets/js/33.028f63f5.js"><link rel="prefetch" href="/assets/js/34.2de17ca3.js"><link rel="prefetch" href="/assets/js/35.1583edcb.js"><link rel="prefetch" href="/assets/js/36.9097fb96.js"><link rel="prefetch" href="/assets/js/37.67bd9375.js"><link rel="prefetch" href="/assets/js/38.4171c61c.js"><link rel="prefetch" href="/assets/js/39.07a0da36.js"><link rel="prefetch" href="/assets/js/4.af96fb9f.js"><link rel="prefetch" href="/assets/js/40.2b632790.js"><link rel="prefetch" href="/assets/js/41.dca58e8c.js"><link rel="prefetch" href="/assets/js/42.d2289409.js"><link rel="prefetch" href="/assets/js/43.497e842b.js"><link rel="prefetch" href="/assets/js/44.506bf15d.js"><link rel="prefetch" href="/assets/js/45.1e58ed01.js"><link rel="prefetch" href="/assets/js/46.1e6edde4.js"><link rel="prefetch" href="/assets/js/47.d7edbd52.js"><link rel="prefetch" href="/assets/js/48.f280b06b.js"><link rel="prefetch" href="/assets/js/49.42e66eaf.js"><link rel="prefetch" href="/assets/js/5.2cb7b5e8.js"><link rel="prefetch" href="/assets/js/50.48a54609.js"><link rel="prefetch" href="/assets/js/51.828abcb3.js"><link rel="prefetch" href="/assets/js/52.69dc5033.js"><link rel="prefetch" href="/assets/js/53.903b3787.js"><link rel="prefetch" href="/assets/js/54.e0469f30.js"><link rel="prefetch" href="/assets/js/55.f7d098ec.js"><link rel="prefetch" href="/assets/js/56.7b725893.js"><link rel="prefetch" href="/assets/js/57.6003dc74.js"><link rel="prefetch" href="/assets/js/58.cb383c55.js"><link rel="prefetch" href="/assets/js/59.9847b5f8.js"><link rel="prefetch" href="/assets/js/6.2eb56668.js"><link rel="prefetch" href="/assets/js/60.958ee998.js"><link rel="prefetch" href="/assets/js/61.212e18f1.js"><link rel="prefetch" href="/assets/js/62.2edb5aba.js"><link rel="prefetch" href="/assets/js/63.0e9159a8.js"><link rel="prefetch" href="/assets/js/64.a9a6dfbc.js"><link rel="prefetch" href="/assets/js/65.37885ab4.js"><link rel="prefetch" href="/assets/js/66.70a0be54.js"><link rel="prefetch" href="/assets/js/67.60449682.js"><link rel="prefetch" href="/assets/js/68.f6ea7c77.js"><link rel="prefetch" href="/assets/js/69.83ebab1a.js"><link rel="prefetch" href="/assets/js/7.c5c6188d.js"><link rel="prefetch" href="/assets/js/70.55b8f211.js"><link rel="prefetch" href="/assets/js/71.f9231218.js"><link rel="prefetch" href="/assets/js/72.749c6492.js"><link rel="prefetch" href="/assets/js/73.4214374e.js"><link rel="prefetch" href="/assets/js/74.5105fa33.js"><link rel="prefetch" href="/assets/js/75.95a538a6.js"><link rel="prefetch" href="/assets/js/76.48500d37.js"><link rel="prefetch" href="/assets/js/77.97631d08.js"><link rel="prefetch" href="/assets/js/78.3104a522.js"><link rel="prefetch" href="/assets/js/79.5e820562.js"><link rel="prefetch" href="/assets/js/8.c08cf1ce.js"><link rel="prefetch" href="/assets/js/80.2f7c4e47.js"><link rel="prefetch" href="/assets/js/81.b378af70.js"><link rel="prefetch" href="/assets/js/82.c3028be0.js"><link rel="prefetch" href="/assets/js/83.93c88ceb.js"><link rel="prefetch" href="/assets/js/84.e4a1dc05.js"><link rel="prefetch" href="/assets/js/85.4744ae10.js"><link rel="prefetch" href="/assets/js/86.922ef2bd.js"><link rel="prefetch" href="/assets/js/87.c36c249e.js"><link rel="prefetch" href="/assets/js/9.e833dac8.js">
    <link rel="stylesheet" href="/assets/css/0.styles.112c01f0.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container" data-v-7dd95ae2><div data-v-7dd95ae2><div class="password-shadow password-wrapper-out" style="display:none;" data-v-59e6cb88 data-v-7dd95ae2 data-v-7dd95ae2><h3 class="title" data-v-59e6cb88>奇风 Java 工程师知识体系</h3> <p class="description" data-v-59e6cb88></p> <label id="box" class="inputBox" data-v-59e6cb88><input type="password" value="" data-v-59e6cb88> <span data-v-59e6cb88>Konck! Knock!</span> <button data-v-59e6cb88>OK</button></label> <div class="footer" data-v-59e6cb88><span data-v-59e6cb88><i class="iconfont reco-theme" data-v-59e6cb88></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-59e6cb88>vuePress-theme-reco</a></span> <span data-v-59e6cb88><i class="iconfont reco-copyright" data-v-59e6cb88></i> <a data-v-59e6cb88><span data-v-59e6cb88>奇风</span>
          
        <!---->
        2023
      </a></span></div></div> <div class="hide" data-v-7dd95ae2><header class="navbar" data-v-7dd95ae2><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="https://cdn.nlark.com/yuque/0/2023/png/375413/1675405507715-d39c0d59-ff2f-48e2-916e-70c5c8a2e62d.png" alt="奇风 Java 工程师知识体系" class="logo"> <span class="site-name">奇风 Java 工程师知识体系</span></a> <div class="links"><div class="color-picker"><a class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="mode-options"><h4 class="title">Choose mode</h4> <ul class="color-mode-options"><li class="dark">dark</li><li class="auto active">auto</li><li class="light">light</li></ul></div></div></div> <div class="search-box"><i class="iconfont reco-search"></i> <input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link"><i class="undefined"></i>
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-document"></i>
      面试
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>常见面试题</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/interview/java-base.html" class="nav-link"><i class="undefined"></i>
  Java 基础
</a></li><li class="dropdown-subitem"><a href="/interview/multi-thread.html" class="nav-link"><i class="undefined"></i>
  多线程
</a></li><li class="dropdown-subitem"><a href="/interview/mysql.html" class="nav-link"><i class="undefined"></i>
  MySql
</a></li><li class="dropdown-subitem"><a href="/interview/jvm.html" class="nav-link"><i class="undefined"></i>
  JVM
</a></li><li class="dropdown-subitem"><a href="/interview/SSM.html" class="nav-link"><i class="undefined"></i>
  企业级框架
</a></li><li class="dropdown-subitem"><a href="/interview/zk.html" class="nav-link"><i class="undefined"></i>
  Zookeeper
</a></li><li class="dropdown-subitem"><a href="/interview/dubbo-netty.html" class="nav-link"><i class="undefined"></i>
  Dubbo 和 netty
</a></li><li class="dropdown-subitem"><a href="/interview/redis.html" class="nav-link"><i class="undefined"></i>
  Redis
</a></li><li class="dropdown-subitem"><a href="/interview/RocketMQ.html" class="nav-link"><i class="undefined"></i>
  RocketMQ
</a></li><li class="dropdown-subitem"><a href="/interview/hr.html" class="nav-link"><i class="undefined"></i>
  非技术问题
</a></li><li class="dropdown-subitem"><a href="/interview/Linux.html" class="nav-link"><i class="undefined"></i>
  Linux
</a></li><li class="dropdown-subitem"><a href="/interview/http tcp.html" class="nav-link"><i class="undefined"></i>
  Http 和 TCP/IP
</a></li><li class="dropdown-subitem"><a href="/interview/distributed.html" class="nav-link"><i class="undefined"></i>
  分布式相关
</a></li><li class="dropdown-subitem"><a href="/interview/project.html" class="nav-link"><i class="undefined"></i>
  项目相关
</a></li><li class="dropdown-subitem"><a href="/interview/es.html" class="nav-link"><i class="undefined"></i>
  Elasticsearch
</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/" class="nav-link"><i class="undefined"></i>
  Java 基础
</a></div><div class="nav-item"><a href="/" class="nav-link"><i class="undefined"></i>
  数据库
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      框架与中间件
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>企业级框架</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/distributed/distributed-base.html" class="nav-link"><i class="undefined"></i>
  Spring
</a></li><li class="dropdown-subitem"><a href="/distributed/consistence-classification.html" class="nav-link"><i class="undefined"></i>
  Mybatis
</a></li><li class="dropdown-subitem"><a href="/distributed/Consensus-alg.html" class="nav-link"><i class="undefined"></i>
  Spring MVC
</a></li></ul></li><li class="dropdown-item"><h4>中间件</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/middleware/redis.html" aria-current="page" class="nav-link router-link-exact-active router-link-active"><i class="undefined"></i>
  Redis
</a></li><li class="dropdown-subitem"><a href="/middleware/RabbitMQ.html" class="nav-link"><i class="undefined"></i>
  RabbitMQ
</a></li><li class="dropdown-subitem"><a href="/middleware/JMS-AMQP.html" class="nav-link"><i class="undefined"></i>
  RocketMQ
</a></li><li class="dropdown-subitem"><a href="/distributed/Raft.html" class="nav-link"><i class="undefined"></i>
  Kafka
</a></li><li class="dropdown-subitem"><a href="/distributed/Multi-Paxos.html" class="nav-link"><i class="undefined"></i>
  Dubbo
</a></li><li class="dropdown-subitem"><a href="/distributed/Gossip.html" class="nav-link"><i class="undefined"></i>
  Netty
</a></li><li class="dropdown-subitem"><a href="/distributed/Zab.html" class="nav-link"><i class="undefined"></i>
  Zookeeper
</a></li><li class="dropdown-subitem"><a href="/distributed/Gossip.html" class="nav-link"><i class="undefined"></i>
  ElasticSearch
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-beian"></i>
      架构
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>架构基础</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/framework/frameworkbase/base/framework-all.html" class="nav-link"><i class="undefined"></i>
  基础知识
</a></li><li class="dropdown-subitem"><a href="/framework/frameworkbase/expand/visual-angle.html" class="nav-link"><i class="undefined"></i>
  拓展知识
</a></li></ul></li><li class="dropdown-item"><h4>单机高性能架构设计</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/framework/high/highperformance/onemachine/zero-copy.html" class="nav-link"><i class="undefined"></i>
  ❤ 零拷贝技术
</a></li><li class="dropdown-subitem"><a href="/framework/high/highperformance/onemachine/linux-5-io.html" class="nav-link"><i class="undefined"></i>
  Linux 5 种 IO 模型
</a></li><li class="dropdown-subitem"><a href="/framework/high/highperformance/onemachine/Reactor-Proactor.html" class="nav-link"><i class="undefined"></i>
  Reactor 与 Proactor
</a></li><li class="dropdown-subitem"><a href="/framework/high/highperformance/onemachine/network opt.html" class="nav-link"><i class="undefined"></i>
  网络方面的优化
</a></li></ul></li><li class="dropdown-item"><h4>高性能架构设计</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/framework/high/highperformance/high/index-high.html" class="nav-link"><i class="undefined"></i>
  指标 - 吞吐量、延迟、TP99
</a></li><li class="dropdown-subitem"><a href="/framework/high/highperformance/high/how2design.html" class="nav-link"><i class="undefined"></i>
  设计高性能系统
</a></li></ul></li><li class="dropdown-item"><h4>高可用架构设计</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/framework/high/highavailable/5-9.html" class="nav-link"><i class="undefined"></i>
  指标 - 几个9、影响请求占比
</a></li><li class="dropdown-subitem"><a href="/framework/high/highavailable/monitor.html" class="nav-link"><i class="undefined"></i>
  设计高可用系统 - 监控
</a></li><li class="dropdown-subitem"><a href="/framework/high/highavailable/conception.html" class="nav-link"><i class="undefined"></i>
  设计高可用系统 - 方案
</a></li></ul></li><li class="dropdown-item"><h4>可扩展架构设计</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/framework/high/highextend/base.html" class="nav-link"><i class="undefined"></i>
  可扩展架构的基本思想和模式
</a></li><li class="dropdown-subitem"><a href="/framework/high/highextend/layered-framework.html" class="nav-link"><i class="undefined"></i>
  可扩展架构 — SOA、微内核架构、微服务
</a></li></ul></li><li class="dropdown-item"><h4>高安全架构设计</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/framework/high/highsafe/encryption-tech.html" class="nav-link"><i class="undefined"></i>
  ❤ 信息加密技术
</a></li><li class="dropdown-subitem"><a href="/framework/high/highsafe/attack-mode.html" class="nav-link"><i class="undefined"></i>
  常见的攻击方式与防火墙
</a></li></ul></li><li class="dropdown-item"><h4>推荐书籍</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/framework/book/start-from-0-framework.html" class="nav-link"><i class="undefined"></i>
  《从 0 开始学架构》
</a></li><li class="dropdown-subitem"><a href="/framework/book/big-website.html" class="nav-link"><i class="undefined"></i>
  《大型网站技术架构：核心原理与案例分析》
</a></li><li class="dropdown-subitem"><a href="/framework/book/DDIA.html" class="nav-link"><i class="undefined"></i>
  《DDIA（数据密集型应用系统设计）》
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-api"></i>
      分布式
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>分布式基础</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/distributed/distributed-base.html" class="nav-link"><i class="undefined"></i>
  cap 与 base 理论
</a></li><li class="dropdown-subitem"><a href="/distributed/consistence-classification.html" class="nav-link"><i class="undefined"></i>
  一致性的分类
</a></li><li class="dropdown-subitem"><a href="/distributed/Consensus-alg.html" class="nav-link"><i class="undefined"></i>
  共识算法
</a></li></ul></li><li class="dropdown-item"><h4>共识算法（一致性算法）</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/distributed/2-stage-commit.html" class="nav-link"><i class="undefined"></i>
  2(3)阶段提交算法
</a></li><li class="dropdown-subitem"><a href="/distributed/paxos-alg.html" class="nav-link"><i class="undefined"></i>
  Paxos 算法
</a></li><li class="dropdown-subitem"><a href="/distributed/Multi-Paxos.html" class="nav-link"><i class="undefined"></i>
  Multi Paxos 算法
</a></li><li class="dropdown-subitem"><a href="/distributed/Gossip.html" class="nav-link"><i class="undefined"></i>
  Gossip 协议
</a></li><li class="dropdown-subitem"><a href="/distributed/Raft.html" class="nav-link"><i class="undefined"></i>
  Raft 算法
</a></li><li class="dropdown-subitem"><a href="/distributed/Zab.html" class="nav-link"><i class="undefined"></i>
  Zab 算法
</a></li></ul></li><li class="dropdown-item"><h4>分布式解决方案</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/distributed/Distributed-lock.html" class="nav-link"><i class="undefined"></i>
  分布式锁
</a></li><li class="dropdown-subitem"><a href="/distributed/Distributed-transaction.html" class="nav-link"><i class="undefined"></i>
  分布式事务
</a></li><li class="dropdown-subitem"><a href="/distributed/distributed-transaction-demo.html" class="nav-link"><i class="undefined"></i>
  分布式事务实现 —— Seata
</a></li><li class="dropdown-subitem"><a href="/distributed/distributed-cache.html" class="nav-link"><i class="undefined"></i>
  分布式缓存一致性
</a></li><li class="dropdown-subitem"><a href="/distributed/distributed-id.html" class="nav-link"><i class="undefined"></i>
  全局唯一 ID
</a></li><li class="dropdown-subitem"><a href="/distributed/distributed-session.html" class="nav-link"><i class="undefined"></i>
  分布式 session
</a></li><li class="dropdown-subitem"><a href="/distributed/distributed-mideng.html" class="nav-link"><i class="undefined"></i>
  幂等实现方案
</a></li><li class="dropdown-subitem"><a href="/distributed/distributed-select.html" class="nav-link"><i class="undefined"></i>
  高性能负载均衡及算法
</a></li><li class="dropdown-subitem"><a href="/middleware/redis-others.html" class="nav-link"><i class="undefined"></i>
  缓存穿透 击穿 雪崩
</a></li><li class="dropdown-subitem"><a href="/distributed/multi-database.html" class="nav-link"><i class="undefined"></i>
  分库分表方案
</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/" class="nav-link"><i class="undefined"></i>
  项目剖析
</a></div><div class="nav-item"><a href="/" class="nav-link"><i class="undefined"></i>
  算法
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      管理
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/manage/career.html" class="nav-link"><i class="undefined"></i>
  职业方向有哪些
</a></li><li class="dropdown-item"><h4>管理方向</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/manage/suitable.html" class="nav-link"><i class="undefined"></i>
  你是否适合做管理
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      关于本站
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/distributed/Distributed-lock.html" class="nav-link"><i class="undefined"></i>
  关于作者
</a></li><li class="dropdown-item"><!----> <a href="/distributed/Distributed-lock.html" class="nav-link"><i class="undefined"></i>
  错误反馈
</a></li><li class="dropdown-item"><!----> <a href="/distributed/Distributed-lock.html" class="nav-link"><i class="undefined"></i>
  最新更新
</a></li><li class="dropdown-item"><h4>作者博文</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/about/about-independent-develop.html" class="nav-link"><i class="undefined"></i>
  关于独立开发的失败尝试
</a></li></ul></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask" data-v-7dd95ae2></div> <aside class="sidebar" data-v-7dd95ae2><div class="personal-info-wrapper" data-v-1fad0c41 data-v-7dd95ae2><!----> <h3 class="name" data-v-1fad0c41>
    奇风
  </h3> <div class="num" data-v-1fad0c41><div data-v-1fad0c41><h3 data-v-1fad0c41>78</h3> <h6 data-v-1fad0c41>文章</h6></div> <div data-v-1fad0c41><h3 data-v-1fad0c41>0</h3> <h6 data-v-1fad0c41>标签</h6></div></div> <ul class="social-links" data-v-1fad0c41></ul> <hr data-v-1fad0c41></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link"><i class="undefined"></i>
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-document"></i>
      面试
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>常见面试题</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/interview/java-base.html" class="nav-link"><i class="undefined"></i>
  Java 基础
</a></li><li class="dropdown-subitem"><a href="/interview/multi-thread.html" class="nav-link"><i class="undefined"></i>
  多线程
</a></li><li class="dropdown-subitem"><a href="/interview/mysql.html" class="nav-link"><i class="undefined"></i>
  MySql
</a></li><li class="dropdown-subitem"><a href="/interview/jvm.html" class="nav-link"><i class="undefined"></i>
  JVM
</a></li><li class="dropdown-subitem"><a href="/interview/SSM.html" class="nav-link"><i class="undefined"></i>
  企业级框架
</a></li><li class="dropdown-subitem"><a href="/interview/zk.html" class="nav-link"><i class="undefined"></i>
  Zookeeper
</a></li><li class="dropdown-subitem"><a href="/interview/dubbo-netty.html" class="nav-link"><i class="undefined"></i>
  Dubbo 和 netty
</a></li><li class="dropdown-subitem"><a href="/interview/redis.html" class="nav-link"><i class="undefined"></i>
  Redis
</a></li><li class="dropdown-subitem"><a href="/interview/RocketMQ.html" class="nav-link"><i class="undefined"></i>
  RocketMQ
</a></li><li class="dropdown-subitem"><a href="/interview/hr.html" class="nav-link"><i class="undefined"></i>
  非技术问题
</a></li><li class="dropdown-subitem"><a href="/interview/Linux.html" class="nav-link"><i class="undefined"></i>
  Linux
</a></li><li class="dropdown-subitem"><a href="/interview/http tcp.html" class="nav-link"><i class="undefined"></i>
  Http 和 TCP/IP
</a></li><li class="dropdown-subitem"><a href="/interview/distributed.html" class="nav-link"><i class="undefined"></i>
  分布式相关
</a></li><li class="dropdown-subitem"><a href="/interview/project.html" class="nav-link"><i class="undefined"></i>
  项目相关
</a></li><li class="dropdown-subitem"><a href="/interview/es.html" class="nav-link"><i class="undefined"></i>
  Elasticsearch
</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/" class="nav-link"><i class="undefined"></i>
  Java 基础
</a></div><div class="nav-item"><a href="/" class="nav-link"><i class="undefined"></i>
  数据库
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      框架与中间件
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>企业级框架</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/distributed/distributed-base.html" class="nav-link"><i class="undefined"></i>
  Spring
</a></li><li class="dropdown-subitem"><a href="/distributed/consistence-classification.html" class="nav-link"><i class="undefined"></i>
  Mybatis
</a></li><li class="dropdown-subitem"><a href="/distributed/Consensus-alg.html" class="nav-link"><i class="undefined"></i>
  Spring MVC
</a></li></ul></li><li class="dropdown-item"><h4>中间件</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/middleware/redis.html" aria-current="page" class="nav-link router-link-exact-active router-link-active"><i class="undefined"></i>
  Redis
</a></li><li class="dropdown-subitem"><a href="/middleware/RabbitMQ.html" class="nav-link"><i class="undefined"></i>
  RabbitMQ
</a></li><li class="dropdown-subitem"><a href="/middleware/JMS-AMQP.html" class="nav-link"><i class="undefined"></i>
  RocketMQ
</a></li><li class="dropdown-subitem"><a href="/distributed/Raft.html" class="nav-link"><i class="undefined"></i>
  Kafka
</a></li><li class="dropdown-subitem"><a href="/distributed/Multi-Paxos.html" class="nav-link"><i class="undefined"></i>
  Dubbo
</a></li><li class="dropdown-subitem"><a href="/distributed/Gossip.html" class="nav-link"><i class="undefined"></i>
  Netty
</a></li><li class="dropdown-subitem"><a href="/distributed/Zab.html" class="nav-link"><i class="undefined"></i>
  Zookeeper
</a></li><li class="dropdown-subitem"><a href="/distributed/Gossip.html" class="nav-link"><i class="undefined"></i>
  ElasticSearch
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-beian"></i>
      架构
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>架构基础</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/framework/frameworkbase/base/framework-all.html" class="nav-link"><i class="undefined"></i>
  基础知识
</a></li><li class="dropdown-subitem"><a href="/framework/frameworkbase/expand/visual-angle.html" class="nav-link"><i class="undefined"></i>
  拓展知识
</a></li></ul></li><li class="dropdown-item"><h4>单机高性能架构设计</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/framework/high/highperformance/onemachine/zero-copy.html" class="nav-link"><i class="undefined"></i>
  ❤ 零拷贝技术
</a></li><li class="dropdown-subitem"><a href="/framework/high/highperformance/onemachine/linux-5-io.html" class="nav-link"><i class="undefined"></i>
  Linux 5 种 IO 模型
</a></li><li class="dropdown-subitem"><a href="/framework/high/highperformance/onemachine/Reactor-Proactor.html" class="nav-link"><i class="undefined"></i>
  Reactor 与 Proactor
</a></li><li class="dropdown-subitem"><a href="/framework/high/highperformance/onemachine/network opt.html" class="nav-link"><i class="undefined"></i>
  网络方面的优化
</a></li></ul></li><li class="dropdown-item"><h4>高性能架构设计</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/framework/high/highperformance/high/index-high.html" class="nav-link"><i class="undefined"></i>
  指标 - 吞吐量、延迟、TP99
</a></li><li class="dropdown-subitem"><a href="/framework/high/highperformance/high/how2design.html" class="nav-link"><i class="undefined"></i>
  设计高性能系统
</a></li></ul></li><li class="dropdown-item"><h4>高可用架构设计</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/framework/high/highavailable/5-9.html" class="nav-link"><i class="undefined"></i>
  指标 - 几个9、影响请求占比
</a></li><li class="dropdown-subitem"><a href="/framework/high/highavailable/monitor.html" class="nav-link"><i class="undefined"></i>
  设计高可用系统 - 监控
</a></li><li class="dropdown-subitem"><a href="/framework/high/highavailable/conception.html" class="nav-link"><i class="undefined"></i>
  设计高可用系统 - 方案
</a></li></ul></li><li class="dropdown-item"><h4>可扩展架构设计</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/framework/high/highextend/base.html" class="nav-link"><i class="undefined"></i>
  可扩展架构的基本思想和模式
</a></li><li class="dropdown-subitem"><a href="/framework/high/highextend/layered-framework.html" class="nav-link"><i class="undefined"></i>
  可扩展架构 — SOA、微内核架构、微服务
</a></li></ul></li><li class="dropdown-item"><h4>高安全架构设计</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/framework/high/highsafe/encryption-tech.html" class="nav-link"><i class="undefined"></i>
  ❤ 信息加密技术
</a></li><li class="dropdown-subitem"><a href="/framework/high/highsafe/attack-mode.html" class="nav-link"><i class="undefined"></i>
  常见的攻击方式与防火墙
</a></li></ul></li><li class="dropdown-item"><h4>推荐书籍</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/framework/book/start-from-0-framework.html" class="nav-link"><i class="undefined"></i>
  《从 0 开始学架构》
</a></li><li class="dropdown-subitem"><a href="/framework/book/big-website.html" class="nav-link"><i class="undefined"></i>
  《大型网站技术架构：核心原理与案例分析》
</a></li><li class="dropdown-subitem"><a href="/framework/book/DDIA.html" class="nav-link"><i class="undefined"></i>
  《DDIA（数据密集型应用系统设计）》
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-api"></i>
      分布式
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>分布式基础</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/distributed/distributed-base.html" class="nav-link"><i class="undefined"></i>
  cap 与 base 理论
</a></li><li class="dropdown-subitem"><a href="/distributed/consistence-classification.html" class="nav-link"><i class="undefined"></i>
  一致性的分类
</a></li><li class="dropdown-subitem"><a href="/distributed/Consensus-alg.html" class="nav-link"><i class="undefined"></i>
  共识算法
</a></li></ul></li><li class="dropdown-item"><h4>共识算法（一致性算法）</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/distributed/2-stage-commit.html" class="nav-link"><i class="undefined"></i>
  2(3)阶段提交算法
</a></li><li class="dropdown-subitem"><a href="/distributed/paxos-alg.html" class="nav-link"><i class="undefined"></i>
  Paxos 算法
</a></li><li class="dropdown-subitem"><a href="/distributed/Multi-Paxos.html" class="nav-link"><i class="undefined"></i>
  Multi Paxos 算法
</a></li><li class="dropdown-subitem"><a href="/distributed/Gossip.html" class="nav-link"><i class="undefined"></i>
  Gossip 协议
</a></li><li class="dropdown-subitem"><a href="/distributed/Raft.html" class="nav-link"><i class="undefined"></i>
  Raft 算法
</a></li><li class="dropdown-subitem"><a href="/distributed/Zab.html" class="nav-link"><i class="undefined"></i>
  Zab 算法
</a></li></ul></li><li class="dropdown-item"><h4>分布式解决方案</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/distributed/Distributed-lock.html" class="nav-link"><i class="undefined"></i>
  分布式锁
</a></li><li class="dropdown-subitem"><a href="/distributed/Distributed-transaction.html" class="nav-link"><i class="undefined"></i>
  分布式事务
</a></li><li class="dropdown-subitem"><a href="/distributed/distributed-transaction-demo.html" class="nav-link"><i class="undefined"></i>
  分布式事务实现 —— Seata
</a></li><li class="dropdown-subitem"><a href="/distributed/distributed-cache.html" class="nav-link"><i class="undefined"></i>
  分布式缓存一致性
</a></li><li class="dropdown-subitem"><a href="/distributed/distributed-id.html" class="nav-link"><i class="undefined"></i>
  全局唯一 ID
</a></li><li class="dropdown-subitem"><a href="/distributed/distributed-session.html" class="nav-link"><i class="undefined"></i>
  分布式 session
</a></li><li class="dropdown-subitem"><a href="/distributed/distributed-mideng.html" class="nav-link"><i class="undefined"></i>
  幂等实现方案
</a></li><li class="dropdown-subitem"><a href="/distributed/distributed-select.html" class="nav-link"><i class="undefined"></i>
  高性能负载均衡及算法
</a></li><li class="dropdown-subitem"><a href="/middleware/redis-others.html" class="nav-link"><i class="undefined"></i>
  缓存穿透 击穿 雪崩
</a></li><li class="dropdown-subitem"><a href="/distributed/multi-database.html" class="nav-link"><i class="undefined"></i>
  分库分表方案
</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/" class="nav-link"><i class="undefined"></i>
  项目剖析
</a></div><div class="nav-item"><a href="/" class="nav-link"><i class="undefined"></i>
  算法
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      管理
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/manage/career.html" class="nav-link"><i class="undefined"></i>
  职业方向有哪些
</a></li><li class="dropdown-item"><h4>管理方向</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/manage/suitable.html" class="nav-link"><i class="undefined"></i>
  你是否适合做管理
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      关于本站
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/distributed/Distributed-lock.html" class="nav-link"><i class="undefined"></i>
  关于作者
</a></li><li class="dropdown-item"><!----> <a href="/distributed/Distributed-lock.html" class="nav-link"><i class="undefined"></i>
  错误反馈
</a></li><li class="dropdown-item"><!----> <a href="/distributed/Distributed-lock.html" class="nav-link"><i class="undefined"></i>
  最新更新
</a></li><li class="dropdown-item"><h4>作者博文</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/about/about-independent-develop.html" class="nav-link"><i class="undefined"></i>
  关于独立开发的失败尝试
</a></li></ul></li></ul></div></div> <!----></nav> <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>企业级架构</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/" aria-current="page" class="sidebar-link">Spring</a></li><li><a href="/" aria-current="page" class="sidebar-link">Spring MVC</a></li><li><a href="/" aria-current="page" class="sidebar-link">Mybatis</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>缓存</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/middleware/redis.html" aria-current="page" class="active sidebar-link">Redis 入门</a></li><li><a href="/middleware/redis-cluster.html" class="sidebar-link">Redis 集群</a></li><li><a href="/middleware/redis-principle.html" class="sidebar-link">Redis 底层数据结构原理</a></li><li><a href="/middleware/redis-others.html" class="sidebar-link">Redis 其他知识点</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>消息队列</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/middleware/JMS-AMQP.html" class="sidebar-link">JMS 与 AMQP 协议</a></li><li><a href="/middleware/RabbitMQ.html" class="sidebar-link">RabbitMQ</a></li><li><a href="/" aria-current="page" class="sidebar-link">RocketMQ</a></li><li><a href="/" aria-current="page" class="sidebar-link">Kafka</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>RPC 框架</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/" aria-current="page" class="sidebar-link">Zookeeper</a></li><li><a href="/" aria-current="page" class="sidebar-link">Dubbo</a></li><li><a href="/" aria-current="page" class="sidebar-link">Netty</a></li></ul></section></li></ul> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-59e6cb88 data-v-7dd95ae2><h3 class="title" data-v-59e6cb88>Redis 入门</h3> <!----> <label id="box" class="inputBox" data-v-59e6cb88><input type="password" value="" data-v-59e6cb88> <span data-v-59e6cb88>Konck! Knock!</span> <button data-v-59e6cb88>OK</button></label> <div class="footer" data-v-59e6cb88><span data-v-59e6cb88><i class="iconfont reco-theme" data-v-59e6cb88></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-59e6cb88>vuePress-theme-reco</a></span> <span data-v-59e6cb88><i class="iconfont reco-copyright" data-v-59e6cb88></i> <a data-v-59e6cb88><span data-v-59e6cb88>奇风</span>
          
        <!---->
        2023
      </a></span></div></div> <div data-v-7dd95ae2><div data-v-7dd95ae2><main class="page"><section style="display:;"><div class="page-title"><h1 class="title">Redis 入门</h1> <div data-v-8a445198><i class="iconfont reco-account" data-v-8a445198><span data-v-8a445198>奇风</span></i> <i class="iconfont reco-date" data-v-8a445198><span data-v-8a445198>2023/2/22</span></i> <i class="iconfont reco-eye" data-v-8a445198><span id="/middleware/redis.html" data-flag-title="Your Article Title" class="leancloud-visitors" data-v-8a445198><a class="leancloud-visitors-count" style="font-size:.9rem;font-weight:normal;color:#999;"></a></span></i> <!----></div></div> <div class="theme-reco-content content__default"><blockquote><p>本文主要内容来自：<a href="https://coding.imooc.com/class/151.html" target="_blank" rel="noopener noreferrer">《一站式学习Redis从入门到高可用分布式实践》<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></blockquote> <h2 id="_1-redis总览"><a href="#_1-redis总览" class="header-anchor">#</a> 1 Redis总览</h2> <h3 id="_1-1-特性"><a href="#_1-1-特性" class="header-anchor">#</a> 1.1 特性</h3> <p><img src="https://cdn.nlark.com/yuque/0/2021/png/375413/1610983515317-495100eb-38e9-4c5c-869d-ce82d78afd4c.png#height=300&amp;id=X3zEb&amp;name=1.png&amp;originHeight=300&amp;originWidth=982&amp;originalType=binary&amp;ratio=1&amp;size=89462&amp;status=done&amp;style=none&amp;width=982" alt="1.png"></p> <h3 id="_1-2-应用场景"><a href="#_1-2-应用场景" class="header-anchor">#</a> 1.2 应用场景</h3> <p><img src="https://cdn.nlark.com/yuque/0/2021/png/375413/1611025793071-35f298d0-c621-42b3-aebe-7c1d3227d684.png#height=247&amp;id=R7fnE&amp;name=DD1B0D87-B526-4F31-B947-43F0F664C2C1.png&amp;originHeight=247&amp;originWidth=1261&amp;originalType=binary&amp;ratio=1&amp;size=74763&amp;status=done&amp;style=none&amp;width=1261" alt="DD1B0D87-B526-4F31-B947-43F0F664C2C1.png"></p> <h2 id="_2-数据结构简单介绍"><a href="#_2-数据结构简单介绍" class="header-anchor">#</a> 2 数据结构简单介绍</h2> <p>使用 redis 3.0 版本</p> <h3 id="_2-1-安装与启动"><a href="#_2-1-安装与启动" class="header-anchor">#</a> 2.1 安装与启动</h3> <h4 id="_2-1-1-安装目录文件"><a href="#_2-1-1-安装目录文件" class="header-anchor">#</a> 2.1.1 安装目录文件</h4> <p><img src="https://cdn.nlark.com/yuque/0/2021/png/375413/1610983604979-60d8f1e4-80d6-4285-a064-16077e580b72.png#height=255&amp;id=LeWCZ&amp;name=3.png&amp;originHeight=255&amp;originWidth=410&amp;originalType=binary&amp;ratio=1&amp;size=39687&amp;status=done&amp;style=none&amp;width=410" alt="3.png"></p> <h4 id="_2-1-2-server-三种启动方式"><a href="#_2-1-2-server-三种启动方式" class="header-anchor">#</a> 2.1.2 server 三种启动方式</h4> <table><thead><tr><th><strong>序号</strong></th> <th><strong>方式</strong></th> <th><strong>说明</strong></th></tr></thead> <tbody><tr><td>1</td> <td>执行命令：redis-server</td> <td>最简启动</td></tr> <tr><td>2</td> <td>执行命令：redis-server --port 6380</td> <td>动态参数启动</td></tr> <tr><td>3</td> <td>执行命令：redis-server configPath</td> <td>配置参数启动</td></tr></tbody></table> <h4 id="_2-1-3-客户端连接"><a href="#_2-1-3-客户端连接" class="header-anchor">#</a> 2.1.3 客户端连接</h4> <p>redis-cli -h [ip] -p [port]
连上之后就可以执行各种操作了</p> <h4 id="_2-1-4-常用配置"><a href="#_2-1-4-常用配置" class="header-anchor">#</a> 2.1.4 常用配置</h4> <ul><li>port：端口（默认6379）</li> <li>logfile：日志文件名称，只是一个文件名</li> <li>dir：Redis的工作目录，logfile、aof等存放的路径</li> <li>RDB config、AOF config、slow Log config、maxMemory等等</li></ul> <h3 id="_2-2-数据结构"><a href="#_2-2-数据结构" class="header-anchor">#</a> 2.2 数据结构</h3> <h4 id="_2-2-1-通用命令"><a href="#_2-2-1-通用命令" class="header-anchor">#</a> 2.2.1 通用命令</h4> <ol><li>keys [pattern]：返回redis中所有的key
<ol><li>keys he*：返回he开头的key</li></ol></li> <li>dbsize：返回redis中key-value的数量</li> <li>exists key：key是否存在</li> <li>del key：删除key，可以删除多个del key1 key2...</li> <li>过期时间：
<ol><li>expire key seconds：设置key的过期时间</li> <li>ttl key：查看key剩余时间</li> <li>persist key：去掉过期时间</li></ol></li> <li>type key：查看key的数据类型</li></ol> <table><thead><tr><th><strong>命令</strong></th> <th><strong>时间复杂度</strong></th> <th><strong>说明</strong></th></tr></thead> <tbody><tr><td>keys</td> <td>O(n)</td> <td>扫描全表，不建议生产环境使用</td></tr> <tr><td>dbsize</td> <td>O(1)</td> <td>redis内部维护一个计数器</td></tr> <tr><td>del</td> <td>O(1)</td> <td></td></tr> <tr><td>exists</td> <td>O(1)</td> <td></td></tr> <tr><td>expire</td> <td>O(1)</td> <td></td></tr> <tr><td>type</td> <td>O(1)</td> <td></td></tr></tbody></table> <h4 id="_2-2-2-数据结构和内部编码"><a href="#_2-2-2-数据结构和内部编码" class="header-anchor">#</a> 2.2.2 数据结构和内部编码</h4> <p>row:[rɔː]</p> <p><img src="https://cdn.nlark.com/yuque/0/2021/png/375413/1610983777803-97693596-6f45-47a2-a9f4-57a3790dd945.png#height=315&amp;id=LIFh1&amp;name=4.png&amp;originHeight=315&amp;originWidth=325&amp;originalType=binary&amp;ratio=1&amp;size=30540&amp;status=done&amp;style=none&amp;width=325" alt="4.png"></p> <h4 id="_2-2-3-单线程"><a href="#_2-2-3-单线程" class="header-anchor">#</a> 2.2.3 单线程</h4> <ol><li>一次只运行一条命令</li> <li>拒绝长（慢）命令：keys,flush all,flushdb，会堵住后面的命令</li> <li>有些功能不是单线程：fysnc file descriptor</li></ol> <p>为什么这么快？</p> <ol><li>纯内存</li> <li>非阻塞IO，select/poll/epoll</li> <li>单线程优势：避免线程切换和静态消耗</li></ol> <h4 id="_2-2-4-基本数据结构一-字符串"><a href="#_2-2-4-基本数据结构一-字符串" class="header-anchor">#</a> 2.2.4 基本数据结构一：字符串</h4> <p><img src="https://cdn.nlark.com/yuque/0/2023/png/375413/1677034552812-5e2cb85f-20b1-4939-b26e-53697aba30e1.png#averageHue=%23f5ea95&amp;clientId=uad6b681b-275a-4&amp;from=paste&amp;height=294&amp;id=u2d1312a9&amp;name=image.png&amp;originHeight=588&amp;originWidth=1510&amp;originalType=binary&amp;ratio=2&amp;rotation=0&amp;showTitle=false&amp;size=240820&amp;status=done&amp;style=none&amp;taskId=ue50b576b-684e-4dfd-b5b1-7e0c6992173&amp;title=&amp;width=755" alt="image.png"></p> <p>mgset和mset的优点：
<img src="https://cdn.nlark.com/yuque/0/2021/png/375413/1610983852790-7ce8e5a8-436a-4825-8290-3a09fe9ea65c.png#height=198&amp;id=Fqyxv&amp;name=5.png&amp;originHeight=434&amp;originWidth=996&amp;originalType=binary&amp;ratio=1&amp;size=36470&amp;status=done&amp;style=none&amp;width=454" alt="5.png">
1次mget = 1次网络时间 + n次命令时间</p> <p>应用：</p> <ol><li><strong>某个人主页被访问次数</strong>，key = userid:pageview；incr userid:pageview（单线程、无并发问题）</li> <li><strong>分布式Id</strong></li> <li><strong>incr id</strong></li></ol> <h4 id="_2-2-5-基本数据结构二-哈希-命令以h开头"><a href="#_2-2-5-基本数据结构二-哈希-命令以h开头" class="header-anchor">#</a> 2.2.5 基本数据结构二：哈希(命令以h开头)</h4> <p><img src="https://cdn.nlark.com/yuque/0/2021/png/375413/1610983900329-61611534-271b-4baf-8bb7-35d0acfd64cb.png#height=246&amp;id=CSevG&amp;name=6.png&amp;originHeight=532&amp;originWidth=832&amp;originalType=binary&amp;ratio=1&amp;size=51603&amp;status=done&amp;style=none&amp;width=384" alt="6.png"></p> <table><thead><tr><th><strong>命令</strong></th> <th><strong>含义</strong></th> <th><strong>命令</strong></th> <th><strong>含义</strong></th></tr></thead> <tbody><tr><td>hget key field</td> <td></td> <td>hmset key field1 value1 field2 value2...</td> <td></td></tr> <tr><td>hget set fileld value</td> <td></td> <td>hvalues key</td> <td>返回这个key对应的所有value</td></tr> <tr><td>hdel key field</td> <td></td> <td>hkeys key</td> <td>返回这个key对应的所有field</td></tr> <tr><td>hexists key field</td> <td></td> <td>hgetall key</td> <td>返回这个key对应的所有field和value</td></tr> <tr><td>hlen key</td> <td>key的field总数</td> <td>hsetnx key field value</td> <td></td></tr> <tr><td>hmget key field1 field2...</td> <td></td> <td>...</td> <td></td></tr></tbody></table> <table><thead><tr><th><strong>命令</strong></th> <th><strong>优点</strong></th> <th><strong>缺点</strong></th></tr></thead> <tbody><tr><td>String key json</td> <td>编程简单</td> <td>序列化开销；设置属性要操作整个数据</td></tr> <tr><td>hash</td> <td>直观；可以部分更新</td> <td>编程稍微复杂；ttl不好控制</td></tr></tbody></table> <h4 id="_2-2-6-基本数据结构三-列表list-命令以l开头"><a href="#_2-2-6-基本数据结构三-列表list-命令以l开头" class="header-anchor">#</a> 2.2.6 基本数据结构三：列表list(命令以l开头)</h4> <p><img src="https://cdn.nlark.com/yuque/0/2021/png/375413/1610984013196-9ee297eb-7e21-4be1-a292-057657899d1b.png#height=50&amp;id=SS3ae&amp;name=7.png&amp;originHeight=80&amp;originWidth=890&amp;originalType=binary&amp;ratio=1&amp;size=12104&amp;status=done&amp;style=none&amp;width=551" alt="7.png"></p> <p>特点：有序、可以重复、支持左右操作</p> <table><thead><tr><th><strong>命令</strong></th> <th><strong>含义</strong></th> <th><strong>命令</strong></th> <th><strong>含义</strong></th></tr></thead> <tbody><tr><td>rpush key value1 value2 ...</td> <td></td> <td>ltrim key startIndex endIndex</td> <td>让列表只保留指定区间内的元素，不在指定区间之内的元素都将被删除</td></tr> <tr><td>lpush key value1 value2 ...</td> <td></td> <td>lrange key startIndex endIndex</td> <td>获取列表指定索引范围所有项目 <br>1. lrange key 0 2：[0,2]，包含end <br>2. lrange key 1 -1：[1,∞）</td></tr> <tr><td>linsert key before|after value newValue</td> <td>在list指定的值前|后插入newValue</td> <td>lindex key index</td> <td>按照索引取值</td></tr> <tr><td>lpop key</td> <td>从左边弹出一个</td> <td>llen key</td> <td>获取列表长度</td></tr> <tr><td>rpop key</td> <td></td> <td>lset key index newValue</td> <td></td></tr> <tr><td>lrem key count value</td> <td>根据count值，从列表中删除所有value相等的项：<br>1. count&gt;0，从左到右，删除最多count个value相等的项 <br>2. count&lt;0，从右到左，删除最多abs(count)个value相等的项 <br>3. count = 0，删除所有value相等的项</td> <td>blpop/brpop，lpop/rpop的阻塞版本</td> <td>取不到数据就阻塞等待，用于生产者和消费者模型</td></tr></tbody></table> <p>应用：微博的TimeLine，查看所有关注的人的动态，按照时间倒序
当关注的人发了动态，就使用lpush插入到你的timeline中</p> <h4 id="_2-2-7-基本数据结构四-set-命令以s开头-集合"><a href="#_2-2-7-基本数据结构四-set-命令以s开头-集合" class="header-anchor">#</a> 2.2.7 基本数据结构四：set(命令以s开头，集合)</h4> <p>特性：value不能有重复元素、无序、支持集合之间的操作
<img src="https://cdn.nlark.com/yuque/0/2021/png/375413/1610984130016-6fac2f83-56cb-4cc7-892d-7a6a0190cfbe.png#height=252&amp;id=GeNpQ&amp;name=8.png&amp;originHeight=404&amp;originWidth=614&amp;originalType=binary&amp;ratio=1&amp;size=25466&amp;status=done&amp;style=none&amp;width=383" alt="8.png"></p> <table><thead><tr><th><strong>命令</strong></th> <th><strong>含义</strong></th> <th><strong>命令</strong></th> <th><strong>含义</strong></th></tr></thead> <tbody><tr><td>sadd key element</td> <td>向集合key添加element，如果存在，添加失败</td> <td>spop key</td> <td>从集合中弹出一个元素</td></tr> <tr><td>srem key element</td> <td>删除集合key中的element元素</td> <td>sdiff key1 key2</td> <td>差集</td></tr> <tr><td>scard key</td> <td>计算集合大小</td> <td>sinter key1 key2</td> <td>交集</td></tr> <tr><td>sismember key element</td> <td>判断元素element是否在集合中</td> <td>sunion key1 key2</td> <td>并集</td></tr> <tr><td>srandmember key count</td> <td>随机从集合中挑count个元素</td> <td></td> <td></td></tr> <tr><td>smembers key</td> <td>取出集合中所有元素</td> <td></td> <td></td></tr></tbody></table> <p>应用：</p> <ul><li>微博的关注，每关注一个，就放一个到value中；</li> <li>共同关注：可以计算出两个user的共同关注sinter方法</li> <li>微博抽奖：如果是可以重复抽奖可以使用srandmember，不可重复抽可以使用spop</li> <li>一条微博有哪些人like、赞、踩，可以使用集合记录</li></ul> <h4 id="_2-2-8-基本数据结构五-zset-命令以z开头-有序集合"><a href="#_2-2-8-基本数据结构五-zset-命令以z开头-有序集合" class="header-anchor">#</a> 2.2.8 基本数据结构五：zset(命令以z开头，有序集合)</h4> <p><img src="https://cdn.nlark.com/yuque/0/2021/png/375413/1610984189985-d365f69f-a0f8-4c10-b1d9-3dc689100e72.png#height=182&amp;id=Ljn6h&amp;name=9.png&amp;originHeight=338&amp;originWidth=836&amp;originalType=binary&amp;ratio=1&amp;size=31142&amp;status=done&amp;style=none&amp;width=450" alt="9.png"></p> <p>集合（set） vs 有序集合（zset）</p> <ol><li>均无重复元素（zset, score能重复，element不能重复）</li> <li>set无序，zset有序</li> <li>set只有element，zset有element + score</li></ol> <table><thead><tr><th><strong>命令</strong></th> <th><strong>含义</strong></th> <th><strong>命令</strong></th> <th><strong>含义</strong></th></tr></thead> <tbody><tr><td>zadd key score element</td> <td>向集合key添加score,element</td> <td>zrangebyscore key score1 score2</td> <td>返回指定分数范围的element</td></tr> <tr><td>zrem key element</td> <td>删除集合key中的element元素</td> <td>zcount key score1 score2</td> <td>返回指定分数范围的element个数</td></tr> <tr><td>zscore key element</td> <td>获取element的score</td> <td>zremrangebyrank key index1 index2</td> <td>按照排名范围删除element</td></tr> <tr><td>zincrby key increScore element</td> <td>给element增加分数</td> <td>zremrangebyscore key score1 score2</td> <td>按照分数范围删除element</td></tr> <tr><td>zcard key</td> <td>返回element的个数</td> <td>zinter、zunion、zdiff</td> <td></td></tr> <tr><td>zrange key index1 index2</td> <td>返回指定索引范围的element</td> <td></td> <td></td></tr></tbody></table> <p>应用：微博热搜榜，每看过一次分数加1</p> <h3 id="_2-3-扩展功能"><a href="#_2-3-扩展功能" class="header-anchor">#</a> 2.3 扩展功能</h3> <p><img src="https://cdn.nlark.com/yuque/0/2021/png/375413/1610984284581-00643310-bdab-4e83-85a7-39dcb2135cca.png#height=210&amp;id=jzXhG&amp;name=10.png&amp;originHeight=210&amp;originWidth=710&amp;originalType=binary&amp;ratio=1&amp;size=16655&amp;status=done&amp;style=none&amp;width=710" alt="10.png"></p> <h4 id="_2-3-1-慢查询日志"><a href="#_2-3-1-慢查询日志" class="header-anchor">#</a> 2.3.1 慢查询日志</h4> <p>redis可以记录执行时间超过某个时长的命令，使用先进先出的队列保存，这个队列固定长度，且是保存在内存中 ；最好是一段时间持久化一次慢查询，因为超过慢查询队列长度，先进的慢查询就会被删除</p> <p>配置：</p> <ol><li>slowlog-max-len：慢查询队列长度，默认是128</li> <li>slowlog-log-slower-than：慢查询日志阈值（微妙，1毫秒 = 1000微妙），默认是10 000 = 10毫秒
<ol><li>设置0，记录所有命令</li> <li>设置小于0，不记录任何命令</li> <li>建议设置成1毫秒（redis通常的qps最少是10000/1秒，每条命令平均0.1毫秒）</li></ol></li></ol> <p>方法：1. 修改配置文件重启；2. 动态配置：config set ...</p> <p>相关命令：</p> <ol><li>slowlog get n ：获取n条慢查询</li> <li>slowlog len：获取慢查询队列有多少个慢查询</li> <li>slowlog reset：清空慢查询</li></ol> <p><img src="https://cdn.nlark.com/yuque/0/2021/png/375413/1610984336539-4d158afa-5fcb-4d57-af28-0dcd897cdec3.png#height=194&amp;id=FHRqQ&amp;name=11.png&amp;originHeight=194&amp;originWidth=681&amp;originalType=binary&amp;ratio=1&amp;size=21120&amp;status=done&amp;style=none&amp;width=681" alt="11.png"></p> <h4 id="_2-3-2-pipeline-批量操作"><a href="#_2-3-2-pipeline-批量操作" class="header-anchor">#</a> 2.3.2 pipeline（批量操作）</h4> <p>redis每条命令的执行时间平均0.1毫秒，这样的话网络就成为了瓶颈</p> <ul><li>N个命令操作：n次网络 + n次命令</li> <li>1次pipeline：1次网络 + n次命令</li></ul> <p>jedis写法：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">Jedis</span> jedis <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Jedis</span><span class="token punctuation">(</span><span class="token string">&quot;127.0.0.1&quot;</span><span class="token punctuation">,</span> <span class="token number">6379</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span><span class="token number">100</span><span class="token punctuation">;</span> i <span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">Pipeline</span> pipeline <span class="token operator">=</span> jedis<span class="token punctuation">.</span><span class="token function">pipelined</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> i <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">;</span> j <span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        pipeline<span class="token punctuation">.</span><span class="token function">hset</span><span class="token punctuation">(</span><span class="token string">&quot;hashkey&quot;</span> <span class="token operator">+</span> j<span class="token punctuation">,</span> <span class="token string">&quot;field&quot;</span> <span class="token operator">+</span> j<span class="token punctuation">,</span> <span class="token string">&quot;value&quot;</span> <span class="token operator">+</span> j<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    pipeline<span class="token punctuation">.</span><span class="token function">syncAndReturnAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>与mget、mset的区别：</p> <p><img src="https://cdn.nlark.com/yuque/0/2021/png/375413/1610984385931-81843c3a-15e5-4b17-9577-ca8256c871a4.png#height=206&amp;id=ythof&amp;name=12.png&amp;originHeight=206&amp;originWidth=461&amp;originalType=binary&amp;ratio=1&amp;size=10098&amp;status=done&amp;style=none&amp;width=461" alt="12.png"></p> <p>pipeline命令不是原子的</p> <p><img src="https://cdn.nlark.com/yuque/0/2021/png/375413/1610984439561-52302740-2944-4746-a5ac-1fb15c9a09db.png#height=211&amp;id=T7gxK&amp;name=13.png&amp;originHeight=211&amp;originWidth=594&amp;originalType=binary&amp;ratio=1&amp;size=12909&amp;status=done&amp;style=none&amp;width=594" alt="13.png"></p> <h4 id="_2-3-3-发布订阅"><a href="#_2-3-3-发布订阅" class="header-anchor">#</a> 2.3.3 发布订阅</h4> <p><img src="https://cdn.nlark.com/yuque/0/2021/png/375413/1610984465765-61f3b7fe-1bed-4cb9-82d4-ebfd1881396f.png#height=304&amp;id=r3d58&amp;name=14.png&amp;originHeight=304&amp;originWidth=522&amp;originalType=binary&amp;ratio=1&amp;size=25487&amp;status=done&amp;style=none&amp;width=522" alt="14.png"></p> <p>注意和消息队列模型的区别：发布订阅是每个订阅者都能收到，消息队列是每个消息只能被一个消费者消费</p> <p>命令：</p> <ol><li>publish channel message：publish sohu:tv &quot;hello world&quot;</li> <li>subscribe channel：subscribe sohu:tv</li> <li>unsubscribe channel</li></ol> <h4 id="_2-3-4-bitmap-位图"><a href="#_2-3-4-bitmap-位图" class="header-anchor">#</a> 2.3.4 bitMap（位图）</h4> <p>bitmap底层是字符串类型，所以value最大为512M</p> <p>字符串big对应的二进制：</p> <p><img src="https://cdn.nlark.com/yuque/0/2021/png/375413/1610984514438-7f2b6f92-2235-4800-85dc-dda8a43825f4.png#height=110&amp;id=ZB0ah&amp;name=15.png&amp;originHeight=110&amp;originWidth=696&amp;originalType=binary&amp;ratio=1&amp;size=11944&amp;status=done&amp;style=none&amp;width=696" alt="15.png"></p> <p>命令：</p> <ol><li>setbit key offset 0/1：把key对于的value的第offset为修改为0或1
<ol><li>如果value只有10位，执行setbit key 50 1，那么10-49都会自动补0</li></ol></li> <li>getbit key offset</li> <li>bitcout key [start end]：获取指定范围值为1的个数</li></ol> <p>应用：独立用户统计，1亿用户，每天大概有5千万人访问，使用set和bitmap的区别：</p> <table><thead><tr><th><strong>数据类型</strong></th> <th><strong>每个userid占用空间</strong></th> <th><strong>需要存储的用户量</strong></th> <th><strong>全部内存量</strong></th></tr></thead> <tbody><tr><td>set</td> <td>32位（假设userid用的是整型）</td> <td>50,000,000</td> <td>32*50,000,000 = 200MB</td></tr> <tr><td>bitmap</td> <td>1位</td> <td>100,000,000</td> <td>1*100,000,000 = 12.5M</td></tr></tbody></table> <p>假如还是1亿用户，但是每天大概只有100万人访问</p> <table><thead><tr><th><strong>数据类型</strong></th> <th><strong>每个userid占用空间</strong></th> <th><strong>需要存储的用户量</strong></th> <th><strong>全部内存量</strong></th></tr></thead> <tbody><tr><td>set</td> <td>32位（假设userid用的是整型）</td> <td>1,000,000</td> <td>32*1,000,000 = 4MB</td></tr> <tr><td>bitmap</td> <td>1位</td> <td>100,000,000</td> <td>1*100,000,000 = 12.5M</td></tr></tbody></table> <p>可以使用用户表的id来决定每个用户所在的位，因为是独立用户访问（去重），所以不能用累加的方式</p> <h4 id="_2-3-5-hyperloglog-极小空间完成独立数量统计"><a href="#_2-3-5-hyperloglog-极小空间完成独立数量统计" class="header-anchor">#</a> 2.3.5 HyperLogLog（极小空间完成独立数量统计）</h4> <p>底层是字符串，<em>原理是伯努利概率论相关的东西</em></p> <p>命令：</p> <ol><li>pfadd key element1 element2...：向hyperloglog添加元素</li> <li>pfcount key：计算这个key的独立总数</li> <li>pfmerge destkey sourcekey1 sourcekey1...：合并多个hyperloglog key到另外一个destkey</li></ol> <p>比bitmap消耗内存量更小，100万个用户，大约只能消耗15KB
缺点：</p> <ol><li>有一定的错误率：0.81%</li> <li>无法知道具体的用户id</li></ol> <h4 id="_2-3-6-geo-地理位置"><a href="#_2-3-6-geo-地理位置" class="header-anchor">#</a> 2.3.6 geo（地理位置）</h4> <p>应用：摇一摇、附近的酒店</p> <h2 id="_3-持久化"><a href="#_3-持久化" class="header-anchor">#</a> 3 持久化</h2> <p>持久化的方式：</p> <ol><li>快照：MySQL Dump、Redis RDB</li> <li>写日志：MySQL binlog、Redis AOF</li></ol> <h3 id="_3-1-快照-rdb-redis-database"><a href="#_3-1-快照-rdb-redis-database" class="header-anchor">#</a> 3.1 快照 RDB（Redis DataBase）</h3> <p><img src="https://cdn.nlark.com/yuque/0/2021/png/375413/1610984625678-7161d45c-0ca9-46b2-8236-18791db67a35.png#height=324&amp;id=r3IwB&amp;name=16.png&amp;originHeight=324&amp;originWidth=861&amp;originalType=binary&amp;ratio=1&amp;size=58903&amp;status=done&amp;style=none&amp;width=861" alt="16.png"></p> <p><em>stop-writes-on-bgsave-error：如果等于 yes</em></p> <p><em>假设 ：创建快照（硬盘上，产生一个新的rdb文件）需要 20s时间，redis主进程，在这20s内，会继续接受客户端命令，但是，就在这20s内，创建快照出错了，比如磁盘满了，那么redis会拒绝新的写入，也就是说，它认为，你当下，持久化数据出现了问题，你就不要再set了</em></p> <table><thead><tr><th><strong>命令</strong></th> <th><strong>save</strong></th> <th><strong>bgsave</strong></th></tr></thead> <tbody><tr><td>IO类型</td> <td>同步</td> <td>异步</td></tr> <tr><td>阻塞</td> <td>是</td> <td>是（阻塞发生在fork）</td></tr> <tr><td>优点</td> <td>不会消耗额外内存</td> <td>不太阻塞redis</td></tr></tbody></table> <h3 id="_3-2-日志-aof-append-only-file"><a href="#_3-2-日志-aof-append-only-file" class="header-anchor">#</a> 3.2 日志 AOF（Append Only File）</h3> <p><img src="https://cdn.nlark.com/yuque/0/2021/png/375413/1610984697200-2ca4d46f-fa96-492f-be21-5deed4bcca1a.png#height=297&amp;id=S6IE7&amp;name=17.png&amp;originHeight=297&amp;originWidth=1057&amp;originalType=binary&amp;ratio=1&amp;size=61462&amp;status=done&amp;style=none&amp;width=1057" alt="17.png"></p> <h4 id="_3-2-1-aof重写"><a href="#_3-2-1-aof重写" class="header-anchor">#</a> 3.2.1 AOF重写</h4> <p>aof重写：例如重写之前</p> <ul><li>set hello world</li> <li>set hello java</li> <li>set hello heee</li></ul> <p>重写之后：set hello hehe，节约磁盘，加速数据恢复</p> <p><strong>AOF重写流程：</strong></p> <p><img src="https://cdn.nlark.com/yuque/0/2021/png/375413/1610984745118-f2e47fff-bae4-48a1-be7b-4e439a8c8fd0.png#height=356&amp;id=h9EWq&amp;name=18.png&amp;originHeight=688&amp;originWidth=1048&amp;originalType=binary&amp;ratio=1&amp;size=78884&amp;status=done&amp;style=none&amp;width=542" alt="18.png"></p> <ul><li>执行 aof 重写请求
<ul><li>如果当前进程正在执行 aof 重写，请求不执行并返回如下响应：ERR Background append only file rewriting already in process</li> <li>如果当前正在执行 bgsave ，重写命令等待 bgsave 完成后执行 ，返回如下响应：Background append only file rewriting shceduled</li></ul></li> <li>父进程执行 fork 创建子进程，等同于bgsave过程</li> <li>父进程 fork 操作完毕之后，依然响应其他命令，所有修改命令依然写入aof_buffer，并写入aof_rewrite_buffer中</li> <li>子进程根据内存快照，按照命令合并规则写入到新的 aof 文件</li> <li>新 aof 文件写入完成之后，子进程通知父进程：
<ul><li>父进程把 aof 重写缓冲区的数据写入 新的 aof 文件</li> <li>使用 新 aof 文件替换 旧的 aof 文件</li></ul></li></ul> <p><strong>AOF参数：</strong></p> <ol><li>appendonly：开启AOF</li> <li>appendfilename：appendonly-${port}.aof</li> <li>appendsync：建议everysec</li> <li>dir：/bigdiskpath</li> <li>no-appendfsync-on-rewrite：在进行aof重写的时候，是否需要执行正常的aof刷盘；设置成yes是不进行，这样可能会丢失些数据（<em>同时在执行bgrewriteaof操作和主进程写aof文件的操作，两者都会操作磁盘，而bgrewriteaof往往会涉及大量磁盘操作，这样就会造成主进程在写aof文件的时候出现阻塞的情形，现在no-appendfsync-on-rewrite参数出场了。如果该参数设置为no，是最安全的方式，不会丢失数据，但是要忍受阻塞的问题</em>）</li> <li>auto-aof-rewrite-percentage</li> <li>auto-aof-rewrite-min-save</li></ol> <div class="custom-block warning"><p class="title"></p><p>RDB默认是打开的，按照：900s/1change，300s/10change，60s/10000chang</p> <p>AOF默认是关闭的</p></div><h3 id="_3-3-rdb-和-aof-比较"><a href="#_3-3-rdb-和-aof-比较" class="header-anchor">#</a> 3.3 RDB 和 AOF 比较</h3> <table><thead><tr><th></th> <th><strong>RDB</strong></th> <th><strong>AOF</strong></th></tr></thead> <tbody><tr><td>恢复/启动优先级</td> <td>低</td> <td>高</td></tr> <tr><td>体积</td> <td>小</td> <td>大</td></tr> <tr><td>恢复速度</td> <td>快</td> <td>慢</td></tr> <tr><td>数据安全</td> <td>丢数据</td> <td>根据策略决定</td></tr> <tr><td>轻重</td> <td>重</td> <td>轻</td></tr></tbody></table> <p>建议：关RDB，开AOF</p> <p><em>如果 Redis 同时使用 RDB 和 AOF 持久化，Redis 会优先使用 AOF 进行恢复数据</em></p> <h3 id="_3-4-常见问题与优化"><a href="#_3-4-常见问题与优化" class="header-anchor">#</a> 3.4 常见问题与优化</h3> <h4 id="_3-4-1-fork问题"><a href="#_3-4-1-fork问题" class="header-anchor">#</a> 3.4.1 fork问题</h4> <ol><li>同步操作，会阻塞主线程</li> <li>与内存量息息相关：内存越大，耗时越长</li> <li>可以通过info stats命令查看最近一次fork的时长latest_fork_usec，可以对这个参数进行监控和告警</li> <li>解决方案：
<ol><li>控制redis实例最大可用内存：maxmemory，小分片</li> <li>监控latest_fork_usec</li> <li>合理配置Linux内存分配策略：vm.overcommit_memory=1，当内存不太够时进行fork会报错</li> <li>降低fork频率：减少bgsave、bgrewriteaof的执行</li></ol></li></ol> <p><em>注：vm.overcommit_memory用来设置内存分配策略，有3个可选值0，1，2：</em></p> <ul><li>0：表示内核将检查是否有足够的可用内存，如果有足够的可用内存，内存申请通过，否则申请失败，并把错误返回给应用进程</li> <li>1：表示内核允许超量使用内存直到用完为止（redis建议配置成这个，能保证fork能最大程度成功）</li> <li>2：表示内核绝不过量使用内存，内存申请不能超过系统的最大内存</li></ul> <h4 id="_3-4-2-子进程开销和优化"><a href="#_3-4-2-子进程开销和优化" class="header-anchor">#</a> 3.4.2 子进程开销和优化</h4> <p>fork操作生成的子进程其实会和主进程共享内存，只有当主进程有写入或修改操作时，子线程会生成一个副本
这就是为什么fork比较快</p> <h4 id="_3-4-3-硬盘优化"><a href="#_3-4-3-硬盘优化" class="header-anchor">#</a> 3.4.3 硬盘优化</h4> <ol><li>不要和高硬盘负载服务部署一起：存储服务、消息队列</li> <li>no-appendfsync-on-rewirte设置成yes</li> <li>根据写入量决定磁盘类型要不要使用SSD</li> <li>单机多实例要控制好，共享资源实例之间的资源分配</li></ol></div></section> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev"><a href="/" class="prev router-link-active">
          Mybatis
        </a></span> <span class="next"><a href="/middleware/redis-cluster.html">
          Redis 集群
        </a></span></p></div> <div class="comments-wrapper"><!----></div></main></div> <!----></div> <ul class="sub-sidebar sub-sidebar-wrapper" style="width:12rem;" data-v-b57cc07c data-v-7dd95ae2><li class="level-2" data-v-b57cc07c><a href="/middleware/redis.html#_1-redis总览" class="sidebar-link reco-side-_1-redis总览" data-v-b57cc07c>1 Redis总览</a></li><li class="level-3" data-v-b57cc07c><a href="/middleware/redis.html#_1-1-特性" class="sidebar-link reco-side-_1-1-特性" data-v-b57cc07c>1.1 特性</a></li><li class="level-3" data-v-b57cc07c><a href="/middleware/redis.html#_1-2-应用场景" class="sidebar-link reco-side-_1-2-应用场景" data-v-b57cc07c>1.2 应用场景</a></li><li class="level-2" data-v-b57cc07c><a href="/middleware/redis.html#_2-数据结构简单介绍" class="sidebar-link reco-side-_2-数据结构简单介绍" data-v-b57cc07c>2 数据结构简单介绍</a></li><li class="level-3" data-v-b57cc07c><a href="/middleware/redis.html#_2-1-安装与启动" class="sidebar-link reco-side-_2-1-安装与启动" data-v-b57cc07c>2.1 安装与启动</a></li><li class="level-3" data-v-b57cc07c><a href="/middleware/redis.html#_2-2-数据结构" class="sidebar-link reco-side-_2-2-数据结构" data-v-b57cc07c>2.2 数据结构</a></li><li class="level-3" data-v-b57cc07c><a href="/middleware/redis.html#_2-3-扩展功能" class="sidebar-link reco-side-_2-3-扩展功能" data-v-b57cc07c>2.3 扩展功能</a></li><li class="level-2" data-v-b57cc07c><a href="/middleware/redis.html#_3-持久化" class="sidebar-link reco-side-_3-持久化" data-v-b57cc07c>3 持久化</a></li><li class="level-3" data-v-b57cc07c><a href="/middleware/redis.html#_3-1-快照-rdb-redis-database" class="sidebar-link reco-side-_3-1-快照-rdb-redis-database" data-v-b57cc07c>3.1 快照 RDB（Redis DataBase）</a></li><li class="level-3" data-v-b57cc07c><a href="/middleware/redis.html#_3-2-日志-aof-append-only-file" class="sidebar-link reco-side-_3-2-日志-aof-append-only-file" data-v-b57cc07c>3.2 日志 AOF（Append Only File）</a></li><li class="level-3" data-v-b57cc07c><a href="/middleware/redis.html#_3-3-rdb-和-aof-比较" class="sidebar-link reco-side-_3-3-rdb-和-aof-比较" data-v-b57cc07c>3.3 RDB 和 AOF 比较</a></li><li class="level-3" data-v-b57cc07c><a href="/middleware/redis.html#_3-4-常见问题与优化" class="sidebar-link reco-side-_3-4-常见问题与优化" data-v-b57cc07c>3.4 常见问题与优化</a></li></ul></div></div></div><div class="global-ui"><div class="back-to-ceiling" style="right:1rem;bottom:6rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;display:none;" data-v-c6073ba8 data-v-c6073ba8><svg t="1574745035067" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5404" class="icon" data-v-c6073ba8><path d="M526.60727968 10.90185116a27.675 27.675 0 0 0-29.21455937 0c-131.36607665 82.28402758-218.69155461 228.01873535-218.69155402 394.07834331a462.20625001 462.20625001 0 0 0 5.36959153 69.94390903c1.00431239 6.55289093-0.34802892 13.13561351-3.76865779 18.80351572-32.63518765 54.11355614-51.75690182 118.55860487-51.7569018 187.94566865a371.06718723 371.06718723 0 0 0 11.50484808 91.98906777c6.53300375 25.50556257 41.68394495 28.14064038 52.69160883 4.22606766 17.37162448-37.73630017 42.14135425-72.50938081 72.80769204-103.21549295 2.18761121 3.04276886 4.15646224 6.24463696 6.40373557 9.22774369a1871.4375 1871.4375 0 0 0 140.04691725 5.34970492 1866.36093723 1866.36093723 0 0 0 140.04691723-5.34970492c2.24727335-2.98310674 4.21612437-6.18497483 6.3937923-9.2178004 30.66633723 30.70611158 55.4360664 65.4791928 72.80769147 103.21549355 11.00766384 23.91457269 46.15860503 21.27949489 52.69160879-4.22606768a371.15156223 371.15156223 0 0 0 11.514792-91.99901164c0-69.36717486-19.13165746-133.82216804-51.75690182-187.92578088-3.42062944-5.66790279-4.76302748-12.26056868-3.76865837-18.80351632a462.20625001 462.20625001 0 0 0 5.36959269-69.943909c-0.00994388-166.08943902-87.32547796-311.81420293-218.6915546-394.09823051zM605.93803103 357.87693858a93.93749974 93.93749974 0 1 1-187.89594924 6.1e-7 93.93749974 93.93749974 0 0 1 187.89594924-6.1e-7z" p-id="5405" data-v-c6073ba8></path><path d="M429.50777625 765.63860547C429.50777625 803.39355007 466.44236686 1000.39046097 512.00932183 1000.39046097c45.56695499 0 82.4922232-197.00623328 82.5015456-234.7518555 0-37.75494459-36.9345906-68.35043303-82.4922232-68.34111062-45.57627738-0.00932239-82.52019037 30.59548842-82.51086798 68.34111062z" p-id="5406" data-v-c6073ba8></path></svg></div><!----></div></div>
    <script src="/assets/js/app.52ddb80d.js" defer></script><script src="/assets/js/3.055d3e19.js" defer></script><script src="/assets/js/1.e976497e.js" defer></script><script src="/assets/js/88.837c1299.js" defer></script>
  </body>
</html>
